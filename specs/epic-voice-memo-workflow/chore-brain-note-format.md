# Chore: Brain Note Format

## Overview

Define the structure and format for brain notes created from voice memos. These notes must be compatible with Cyborg's brain regenerate system and searchable via tags.

## Approach

Brain notes use single markdown files with YAML frontmatter in a flat directory structure. This provides simplicity, portability, and standard markdown compatibility.

## Brain Note Structure

### Option A: Single File with Frontmatter

```markdown
brain/
└── <title>.md

# File content:
---
title: Bug Fix Authentication Issue
created: 2026-01-22T14:30:00Z
tags: [bug-fix, authentication, security]
source: voice-memo
audio: .aura/output/bug-fix-authentication/audio.wav
---

# Bug Fix Authentication Issue

<processed content from transcript>

## Original Transcript

<raw transcript for reference>
```

### Option B: Subdirectory per Note

```markdown
brain/
└── <title>/
    ├── note.md          # Main content
    ├── metadata.yaml    # Structured metadata
    └── audio.wav        # Original audio (optional copy)

# note.md:
# Bug Fix Authentication Issue

<processed content>

# metadata.yaml:
title: Bug Fix Authentication Issue
created: 2026-01-22T14:30:00Z
tags:
  - bug-fix
  - authentication
  - security
source: voice-memo
transcript: ../../.aura/output/bug-fix-authentication/transcript.txt
```

### Option C: Flat with Tag Files

```markdown
brain/
├── bug-fix-authentication.md
└── _tags/
    ├── bug-fix.md       # Lists all notes with this tag
    ├── authentication.md
    └── security.md
```

## Selected Format

**Single File with Frontmatter** (Option A above)

**Rationale**:
- Simplest to implement
- Standard markdown format
- Portable (single file = single note)
- Frontmatter widely supported
- Easy to grep/search

**Tag Format**:
```yaml
tags: [category, subcategory, keywords]
```

**Required Fields**:
```yaml
title: <generated title>
created: <ISO 8601 timestamp>
tags: [<auto-generated + manual tags>]
source: voice-memo
```

## Auto-Tagging Strategy

When creating brain notes from voice memos, auto-generate tags:

1. **From Intent**:
   - Research intent → `#research`
   - Code intent → `#code`, `#example`
   - Summary intent → `#summary`

2. **From Content** (keyword extraction):
   - Technical terms → tags (OAuth, API, React)
   - Action verbs → tags (refactor, implement, fix)
   - Domain concepts → tags (authentication, frontend, database)

3. **From Context**:
   - All voice memos → `#voice-memo`
   - Timestamp-based → `#2026-01`, `#2026-01-22`

**Example**:
```yaml
Transcript: "Research OAuth 2.0 implementation patterns for React apps"

Generated tags:
  - research
  - oauth
  - authentication
  - react
  - implementation
  - voice-memo
  - 2026-01
```

## Implementation Tasks

- [ ] Investigate Cyborg's existing brain structure (check `incubator/cyborg/brain/`)
- [ ] Review Cyborg's regenerate command to understand requirements
- [ ] Choose directory structure (Option A, B, or C)
- [ ] Define required frontmatter fields
- [ ] Implement auto-tagging logic
- [ ] Document format in CLAUDE.md
- [ ] Create example brain notes for testing

## Acceptance Criteria

- [ ] Brain note format is documented
- [ ] Format is compatible with Cyborg's regenerate system
- [ ] Tags are searchable (via grep or Cyborg tools)
- [ ] Notes can be manually edited after creation
- [ ] Format is human-readable and git-friendly
- [ ] Auto-tagging produces relevant tags (>80% accuracy)

## Testing Plan

### Manual Testing

1. **Create Test Note**:
   ```bash
   # Manually create a brain note following the format
   # Verify it's readable and well-structured
   ```

2. **Test Regenerate**:
   ```bash
   # If Cyborg has regenerate command:
   brain regenerate
   # Verify note is included and processed correctly
   ```

3. **Test Search**:
   ```bash
   # Search by tag
   grep -r "tags:.*authentication" brain/
   # Verify notes are findable
   ```

### Integration Testing

1. Create brain note from voice memo
2. Verify format matches specification
3. Test with Cyborg regenerate (if available)
4. Edit note manually, verify edits persist

## Documentation

- [ ] Document brain note format in CLAUDE.md
- [ ] Add examples to `/cyborg.process` command
- [ ] Update Cyborg README with voice memo workflow

## Dependencies

- Requires: Understanding of Cyborg's brain system
- Must complete before: [Feature: Cyborg Process Command](./feature-cyborg-process.md)

## Implementation Notes

- Check existing Cyborg brain notes to validate format compatibility
- Test with brain regenerate to ensure indexing works
- Performance should be fine with flat structure and grep-based search
- Note linking/backrefs can be added later as enhancement

## Notes

- Keep format simple and extensible
- Prioritize human readability
- Git-friendly (text-based, no binary formats)
- Consider future: graph visualization of tagged notes
- Consider future: auto-linking related notes by tag similarity
